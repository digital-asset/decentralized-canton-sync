<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Synchronizer Upgrades with Downtime &mdash; Splice  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=06d34380"></script>
        <script src="../_static/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Backups" href="sv_backup.html" />
    <link rel="prev" title="Upgrades" href="sv_upgrades.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Splice
          </a>
              <div class="version">
                0.3.11-ci-snapshot.20250211.1.0.v6e8bfe09
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Deployment and Operations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validator_operator/index.html">Validators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_onboarding.html">Validator Onboarding Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_onboarding.html#networks">Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_onboarding.html#onboarding-process-overview">Onboarding Process Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_onboarding.html#validating-that-your-ip-has-been-approved">Validating that your IP has been approved</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_onboarding.html#stay-connected">Stay Connected</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_onboarding.html#slack">Slack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_onboarding.html#mailing-lists">Mailing Lists</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_hardware_requirements.html">Validator Hardware Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_hardware_requirements.html#database-latency">Database Latency</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_compose.html">Docker-Compose Based Deployment of a Validator Node</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#required-network-parameters">Required Network Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#preparing-for-validator-onboarding">Preparing for Validator Onboarding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#logging-into-the-wallet-ui">Logging into the wallet UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#logging-into-the-cns-ui">Logging into the CNS UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_compose.html#configuring-authentication">Configuring Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_helm.html">Kubernetes-Based Deployment of a Validator node</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#requirements">Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#required-network-parameters">Required Network Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#validator-network-diagram">Validator Network Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#preparing-a-cluster-for-installation">Preparing a Cluster for Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-postgresql-authentication">Configuring PostgreSQL authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#preparing-for-validator-onboarding">Preparing for Validator Onboarding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-authentication">Configuring Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#oidc-provider-requirements">OIDC Provider Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-an-auth0-tenant">Configuring an Auth0 Tenant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-authentication-on-your-validator">Configuring Authentication on your Validator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#installing-the-software">Installing the Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-the-helm-charts">Configuring the Helm Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#installing-the-helm-charts">Installing the Helm Charts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-the-cluster-ingress">Configuring the Cluster Ingress</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#id5">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_helm.html#installation-instructions">Installation Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#logging-into-the-wallet-ui">Logging into the wallet UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#testnet-only-granting-coin-to-the-validator-for-traffic-purchases">(TestNet-only) Granting coin to the validator for traffic purchases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#logging-into-the-cns-ui">Logging into the CNS UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-automatic-traffic-purchases">Configuring automatic traffic purchases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#configuring-sweeps-and-auto-accepts-of-transfer-offers">Configuring sweeps and auto-accepts of transfer offers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_helm.html#participant-pruning">Participant Pruning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_upgrades.html">Upgrades</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html">Synchronizer Upgrades with Downtime</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#technical-details">Technical Details</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#state-and-migration-ids">State and Migration IDs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#migration-dumps">Migration Dumps</a></li>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#catching-up-before-the-migration">Catching Up Before the Migration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#deploying-the-validator-app-and-participant-kubernetes">Deploying the Validator App and Participant (Kubernetes)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_major_upgrades.html#deploying-the-validator-app-and-participant-docker-compose">Deploying the validator App and Participant (Docker-Compose)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_backups.html">Backups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_backups.html#backup-of-node-identities">Backup of Node Identities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_backups.html#backups-of-postgres-instances">Backups of postgres instances</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html">Disaster Recovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#restoring-a-validator-from-backups">Restoring a validator from backups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#re-onboard-a-validator-and-recover-balances-of-all-users-it-hosts">Re-onboard a validator and recover balances of all users it hosts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#docker-compose-deployment">Docker-Compose Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#kubernetes-deployment">Kubernetes Deployment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#disaster-recovery-from-loss-of-the-cometbft-storage-layer-of-the-global-synchronizer">Disaster recovery from loss of the CometBFT storage layer of the global synchronizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_disaster_recovery.html#technical-details">Technical Details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_security.html">Security Hardening</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_security.html#using-an-external-kms-for-managing-participant-keys">Using an external KMS for managing participant keys</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_security.html#migrating-an-existing-validator-to-use-an-external-kms">Migrating an existing validator to use an external KMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../validator_operator/validator_security.html#configuring-a-fresh-validator-to-use-an-external-kms">Configuring a fresh validator to use an external KMS</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_security.html#google-cloud-kms">Google Cloud KMS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../validator_operator/validator_security.html#amazon-web-services-kms">Amazon Web Services KMS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_users.html">Users, Parties and Wallets in the Splice Wallet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../validator_operator/validator_networking.html">Validator Ingress &amp; Egress requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_networking.html#ingress">Ingress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validator_operator/validator_networking.html#egress">Egress</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Supervalidators</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sv_helm.html">Kubernetes-Based Deployment of a Super Validator node</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#generating-an-sv-identity">Generating an SV identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#preparing-a-cluster-for-installation">Preparing a Cluster for Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#configuring-authentication">Configuring Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#oidc-provider-requirements">OIDC Provider Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#configuring-an-auth0-tenant">Configuring an Auth0 Tenant</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#configuring-authentication-on-your-sv-node">Configuring Authentication on your SV Node</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#configuring-your-cometbft-node">Configuring your CometBft node</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#generating-your-cometbft-node-keys">Generating your CometBft node keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#configuring-your-cometbft-node-keys">Configuring your CometBft node keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#configuring-cometbft-state-sync">Configuring CometBft state sync</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#installing-postgres-instances">Installing Postgres instances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#creating-k8s-secrets-for-postgres-passwords">Creating k8s Secrets for Postgres Passwords</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#postgres-in-the-cluster">Postgres in the Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#cloud-hosted-postgres">Cloud-Hosted Postgres</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#installing-the-software">Installing the Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#configuring-the-helm-charts">Configuring the Helm Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#installing-the-helm-charts">Installing the Helm Charts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#sv-network-diagram">SV Network Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#configuring-the-cluster-ingress">Configuring the Cluster Ingress</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#hostnames-and-urls">Hostnames and URLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#ingress-configuration">Ingress Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#id5">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_helm.html#installation-instructions">Installation Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#configuring-the-cluster-egress">Configuring the Cluster Egress</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#logging-into-the-wallet-ui">Logging into the wallet UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#logging-into-the-cns-ui">Logging into the CNS UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#logging-into-the-sv-ui">Logging into the SV UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_helm.html#observing-the-canton-coin-scan-ui">Observing the Canton Coin Scan UI</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="sv_upgrades.html">Upgrades</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Synchronizer Upgrades with Downtime</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#technical-details">Technical Details</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#state-and-migration-ids">State and Migration IDs</a></li>
<li class="toctree-l5"><a class="reference internal" href="#migration-dumps">Migration Dumps</a></li>
<li class="toctree-l5"><a class="reference internal" href="#deploying-new-canton-components-and-cometbft-node">Deploying new Canton Components and CometBFT Node</a></li>
<li class="toctree-l5"><a class="reference internal" href="#catching-up-before-the-migration">Catching Up Before the Migration</a></li>
<li class="toctree-l5"><a class="reference internal" href="#updating-apps">Updating Apps</a></li>
<li class="toctree-l5"><a class="reference internal" href="#recovering-from-a-failed-upgrade">Recovering from a failed upgrade</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#organizational-details">Organizational Details</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#coordination-calls">Coordination calls</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#individual-preparation">Individual Preparation</a></li>
<li class="toctree-l5"><a class="reference internal" href="#coordinated-tests">Coordinated Tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sv_backup.html">Backups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sv_backup.html#backup-of-node-identities">Backup of Node Identities</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_backup.html#backup-of-postgres-instances">Backup of Postgres Instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_backup.html#backup-of-cometbft">Backup of CometBFT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sv_restore.html">Disaster Recovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sv_restore.html#restoring-from-data-corruption">Restoring From Data Corruption</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_restore.html#restoring-a-single-component-from-backups">Restoring a single component from backups</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_restore.html#restoring-a-full-sv-node-from-backups">Restoring a full SV node from backups</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_restore.html#re-onboard-an-sv-and-recover-amulets-with-a-validator">Re-onboard an SV and recover Amulets with a validator</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_restore.html#disaster-recovery-from-loss-of-cometbft-layer">Disaster recovery from loss of CometBFT layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_restore.html#technical-details">Technical Details</a><ul>
<li class="toctree-l5"><a class="reference internal" href="sv_restore.html#finding-a-consistent-timestamp-to-recover-the-synchronizer-from">Finding a Consistent Timestamp to Recover the Synchronizer From</a></li>
<li class="toctree-l5"><a class="reference internal" href="sv_restore.html#creating-a-data-dump-from-the-sv-app">Creating a Data Dump from the SV App</a></li>
<li class="toctree-l5"><a class="reference internal" href="sv_restore.html#migrating-the-data">Migrating the Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sv_operations.html">SV Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sv_operations.html#security-notice">Security Notice</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_operations.html#generate-a-validator-onboarding-secret">Generate a validator onboarding secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_operations.html#sv-identities-overview">Identities used by SV nodes on different layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sv_operations.html#sv-identity">SV identity</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_operations.html#participant-identities">Participant identities</a></li>
<li class="toctree-l4"><a class="reference internal" href="sv_operations.html#cometbft-node-identities">CometBFT node identities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sv_operations.html#updating-the-reward-weight-of-an-sv">Updating the reward weight of an SV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sv_scratchnet.html">How to Bootstrap a Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#cometbft-helm-values">cometbft helm values</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#scan-helm-values">scan helm values</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#sv-helm-values">sv helm values</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#other-helm-values-you-may-need-to-consider">other helm values you may need to consider</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#infra-level-things-you-might-want-to-consider">Infra-level things you might want to consider</a></li>
<li class="toctree-l3"><a class="reference internal" href="sv_scratchnet.html#how-to-run-through-a-hdm">How to run through a HDM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/index.html">Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../deployment/observability/index.html">Monitoring and Observability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/observability/metrics.html">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics.html#scraping-the-metrics">Scraping the metrics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics.html#configuring-a-helm-deployment-to-enable-metrics">Configuring a helm deployment to enable metrics</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics.html#configuring-a-docker-compose-deployment-to-enable-metrics">Configuring a docker compose deployment to enable metrics</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics.html#grafana-dashboards">Grafana Dashboards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/observability/metrics_reference.html">Metrics Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics_reference.html#common-metrics">Common Metrics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-domain-params-store-confirmation-requests-max-rate">splice.domain_params_store.confirmation-requests-max-rate</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-store-signal-when-ingested-latency">splice.store.signal-when-ingested-latency</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-store-acs-size">splice.store.acs-size</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client">daml.grpc.client</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-messages-sent">daml.grpc.client.messages.sent</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-messages-received">daml.grpc.client.messages.received</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-messages-sent-bytes">daml.grpc.client.messages.sent.bytes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-messages-received-bytes">daml.grpc.client.messages.received.bytes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-started">daml.grpc.client.started</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#daml-grpc-client-completed">daml.grpc.client.completed</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-trigger-latency">splice.trigger.latency</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-trigger-iterations">splice.trigger.iterations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-trigger-completed">splice.trigger.completed</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics_reference.html#validator-metrics">Validator Metrics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-wallet-unlocked-amulet-balance">splice.wallet.unlocked-amulet-balance</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-wallet-locked-amulet-balance">splice.wallet.locked-amulet-balance</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics_reference.html#sv-metrics">SV Metrics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-dso-store-latest-open-mining-round">splice.sv_dso_store.latest-open-mining-round</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sequencer-pruning-latency">splice.sequencer_pruning.latency</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sequencer-pruning-disabled-members">splice.sequencer_pruning.disabled_members</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-cometbft-earliest-block-height">splice.sv_cometbft.earliest_block_height</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-cometbft-latest-block-height">splice.sv_cometbft.latest_block_height</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-status-report-number">splice.sv_status_report.number</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-status-report-creation-time-us">splice.sv_status_report.creation_time_us</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-status-report-cometbft-height">splice.sv_status_report.cometbft_height</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-status-report-domain-time-us">splice.sv_status_report.domain_time_us</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#id2">splice.sv_status_report.domain_time_us</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-sv-status-report-latest-open-round">splice.sv_status_report.latest_open_round</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/observability/metrics_reference.html#scan-metrics">Scan Metrics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-scan-store-earliest-aggregated-round">splice.scan_store.earliest-aggregated-round</a></li>
<li class="toctree-l5"><a class="reference internal" href="../deployment/observability/metrics_reference.html#splice-scan-store-latest-aggregated-round">splice.scan_store.latest-aggregated-round</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/configuration.html">Configuring deployed apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/configuration.html#adding-ad-hoc-configuration">Adding ad-hoc configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/configuration.html#helm-charts-support">Helm charts support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/console_access.html">Getting console access to Canton nodes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/console_access.html#participant-console">Participant console</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/console_access.html#sequencer-console">Sequencer console</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/console_access.html#mediator-console">Mediator console</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/console_access.html#access-in-a-k8s-cluster">Access in a K8s cluster</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/troubleshooting.html#where-to-find-logs">Where to find logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/troubleshooting.html#debugging-issues-in-web-uis">Debugging issues in Web UIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/troubleshooting.html#configurations">Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/troubleshooting.html#common-error-messages">Common Error Messages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/troubleshooting.html#traffic-balance-below-reserved-amount">Traffic balance below reserved amount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/troubleshooting.html#insufficient-funds-to-buy-configured-traffic-amount">Insufficient funds to buy configured traffic amount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/troubleshooting.html#gave-up-getting-app-version">Gave up getting app version</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/overview/index.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/overview/read-only-apps.html">Read-Only Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/overview/daml-apps.html">Daml Apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/daml-apps.html#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/daml-apps.html#ledger-ingestion">Ledger Ingestion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/overview/version_information.html">Version Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/overview/splice_app_apis.html">Splice App APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/splice_app_apis.html#openapi-specifications">OpenAPI Specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/splice_app_apis.html#api-stability">API Stability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/splice_app_apis.html#contract-payload-encoding">Contract Payload Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/overview/splice_app_apis.html#authentication">Authentication</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/scan_api/index.html">Scan API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/validator_api/index.html">Validator API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#user-wallet-api">User wallet API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/validator_api/index.html#transfer-offers">Transfer Offers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/validator_api/index.html#buying-traffic">Buying Traffic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#internal-user-wallet-api">Internal user wallet API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#external-custody-api">External Custody API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#user-management-api">User management API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#validator-management-api">Validator management API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#ans-api">ANS API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/validator_api/index.html#scan-proxy-api">Scan Proxy API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/ledger_api/index.html">Ledger API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/daml_api/index.html">Daml API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-amulet/index.html">splice-amulet docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Amulet.html">Splice.Amulet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Amulet.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Amulet.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Amulet.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletConfig.html">Splice.AmuletConfig</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletConfig.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletConfig.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletRules.html">Splice.AmuletRules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletRules.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletRules.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-AmuletRules.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-DecentralizedSynchronizer.html">Splice.DecentralizedSynchronizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-DecentralizedSynchronizer.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-DecentralizedSynchronizer.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-DecentralizedSynchronizer.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Expiry.html">Splice.Expiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Expiry.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Expiry.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ExternalPartyAmuletRules.html">Splice.ExternalPartyAmuletRules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ExternalPartyAmuletRules.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ExternalPartyAmuletRules.html#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Fees.html">Splice.Fees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Fees.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Fees.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Issuance.html">Splice.Issuance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Issuance.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Issuance.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-RelRound.html">Splice.RelRound</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-RelRound.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-RelRound.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Round.html">Splice.Round</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Round.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Round.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Schedule.html">Splice.Schedule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Schedule.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Schedule.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Types.html">Splice.Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Types.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-Types.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ValidatorLicense.html">Splice.ValidatorLicense</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ValidatorLicense.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ValidatorLicense.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet/Splice-ValidatorLicense.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-amulet-name-service/index.html">splice-amulet-name-service docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-amulet-name-service/Splice-Ans.html">Splice.Ans</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet-name-service/Splice-Ans.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet-name-service/Splice-Ans.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-amulet-name-service/Splice-Ans.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-dso-governance/index.html">splice-dso-governance docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-CometBft.html">Splice.CometBft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-CometBft.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-CometBft.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-AmuletPrice.html">Splice.DSO.AmuletPrice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-AmuletPrice.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-AmuletPrice.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-DecentralizedSynchronizer.html">Splice.DSO.DecentralizedSynchronizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-DecentralizedSynchronizer.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-DecentralizedSynchronizer.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-SvState.html">Splice.DSO.SvState</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-SvState.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DSO-SvState.html#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoBootstrap.html">Splice.DsoBootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoBootstrap.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoBootstrap.html#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoRules.html">Splice.DsoRules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoRules.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoRules.html#orphan-typeclass-instances">Orphan Typeclass Instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoRules.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-DsoRules.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-SvOnboarding.html">Splice.SvOnboarding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-SvOnboarding.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-dso-governance/Splice-SvOnboarding.html#data-types">Data Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-util/index.html">splice-util docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-util/Splice-Util.html">Splice.Util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-util/Splice-Util.html#typeclasses">Typeclasses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-util/Splice-Util.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-validator-lifecycle/index.html">splice-validator-life-cycle docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-validator-lifecycle/Splice-ValidatorOnboarding.html">Splice.ValidatorOnboarding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-validator-lifecycle/Splice-ValidatorOnboarding.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-validator-lifecycle/Splice-ValidatorOnboarding.html#data-types">Data Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-wallet/index.html">splice-wallet docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-BuyTrafficRequest.html">Splice.Wallet.BuyTrafficRequest</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-BuyTrafficRequest.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-BuyTrafficRequest.html#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-Install.html">Splice.Wallet.Install</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-Install.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-Install.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-Install.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TopUpState.html">Splice.Wallet.TopUpState</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TopUpState.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TopUpState.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferOffer.html">Splice.Wallet.TransferOffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferOffer.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferOffer.html#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferPreapproval.html">Splice.Wallet.TransferPreapproval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferPreapproval.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet/Splice-Wallet-TransferPreapproval.html#data-types">Data Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/index.html">splice-wallet-payments docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Payment.html">Splice.Wallet.Payment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Payment.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Payment.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Payment.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Subscriptions.html">Splice.Wallet.Subscriptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Subscriptions.html#templates">Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Subscriptions.html#data-types">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../app_dev/api/splice-wallet-payments/Splice-Wallet-Subscriptions.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../app_dev/testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/testing/localnet.html">Docker-Compose Based Deployment of a Local Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/localnet.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/localnet.html#depoying-the-nodes">Depoying the nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/localnet.html#uis">UIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/testing/networks_and_usecases.html">SV Operated networks and Use-cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/networks_and_usecases.html#devnet">DevNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/networks_and_usecases.html#testnet">TestNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app_dev/testing/networks_and_usecases.html#mainnet">MainNet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../app_dev/testing/networks_and_usecases.html#testing-guidelines">Testing Guidelines</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#upcoming">Upcoming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id2">0.3.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id3">0.3.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id4">0.3.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id5">0.3.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id6">0.3.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id7">0.3.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id8">0.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id9">0.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id10">0.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id11">0.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id12">0.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../release_notes.html#daml-changes-in-0-3-0">Daml Changes in 0.3.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id13">0.2.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id14">0.2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id15">0.2.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id16">0.2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id17">0.2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id18">0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id19">0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id20">0.1.19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id21">0.1.18</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id22">0.1.17</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id23">0.1.16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id24">0.1.15</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id25">0.1.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id26">0.1.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id27">0.1.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id28">0.1.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id29">0.1.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id30">0.1.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id31">0.1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id32">0.1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id33">0.1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id34">0.1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id35">0.1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id36">2024-04-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id37">2024-03-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id38">2024-03-18</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id39">2024-03-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id40">2024-03-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id41">2024-02-26</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id42">2024-02-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id43">2024-02-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id44">2024-02-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id45">2024-01-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id46">2024-01-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id47">2024-01-15</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id48">2024-01-08</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id49">2023-12-18</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id50">2023-12-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id51">2023-12-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id52">2023-11-27</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id53">2023-11-20</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id54">2023-11-13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id55">2023-11-06</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id56">2023-10-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id57">2023-10-23</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id58">2023-10-16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id59">2023-10-09</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id60">2023-10-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id61">2023-09-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id62">2023-09-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id63">2023-09-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id64">2023-08-28</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id65">2023-08-14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id66">2023-08-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id67">2023-07-31</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id68">2023-07-16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id69">2023-07-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id70">2023-06-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id71">2023-06-18</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id72">2023-06-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id73">2023-06-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id74">2023-05-28</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id75">2023-05-21</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id76">2023-05-14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id77">2023-05-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id78">2023-04-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#id79">2023-04-23</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Splice</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Supervalidators</a></li>
          <li class="breadcrumb-item"><a href="sv_upgrades.html">Upgrades</a></li>
      <li class="breadcrumb-item active">Synchronizer Upgrades with Downtime</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sv_operator/sv_major_upgrade.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="synchronizer-upgrades-with-downtime">
<span id="sv-upgrades"></span><h1>Synchronizer Upgrades with Downtime<a class="headerlink" href="#synchronizer-upgrades-with-downtime" title="Link to this heading"></a></h1>
<p>For supporting non-backwards-compatible major version upgrades of the Canton software the Global Synchronizer uses,
the SV operatores follow the procedure for synchronizer (i.e., domain) upgrades with downtime described below.</p>
<section id="overview">
<span id="sv-upgrades-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Canton releases containing breaking changes become available and Splice releases compatible with these Canton releases become available.</p></li>
<li><p>SVs agree and eventually confirm via an on-ledger vote (cast via the SV UI) on which specific date and time the network downtime necessary for the upgrade will start. It is the responsibility of the DSO to make sure that validator operators are informed about planned upgrades and upgrade timelines.</p></li>
<li><p>Once the downtime has been scheduled, all SVs deploy new Kubernetes pods containing the new versions of the Canton components of their Super Validator node (participant, sequencer, and mediator) as well as a new CometBFT node, alongside the old versioned ones which are not yet deleted. See <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a>.</p></li>
<li><p>At the start of the downtime window, the SV app of SVs automatically pauses all traffic on the operating version of the global synchronizer.</p></li>
<li><p>Shortly after pausing traffic on the global synchronizer (there is a short delay to ensure that all components have synced up to the final state of the existing synchronizer), the node software of SVs and validators automatically exports so-called migration dumps to attached Kubernetes volumes. See <a class="reference internal" href="#sv-upgrades-dumps"><span class="std std-ref">Migration Dumps</span></a>.</p></li>
<li><p>SV operators verify that their nodes have caught up to the now-paused global synchronizer. See <a class="reference internal" href="#sv-upgrades-catching-up"><span class="std std-ref">Catching Up Before the Migration</span></a>.</p></li>
<li><p>All SVs and validators previously using the now-paused global synchronizer create full backups of their nodes. (Both for disaster recovery and for supporting audit requirements). See <a class="reference internal" href="sv_backup.html#sv-backups"><span class="std std-ref">Backups</span></a>.</p></li>
<li><p>All SVs upgrade theirs CN apps pods. See <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>.</p></li>
<li><p>Upon (re-)initialization, the SV node backend automatically consumes the migration dump and initializes all components based on the contents of this dump. The process is analogous for validators, where the validator app is tasked with importing the dump and initializing components. App databases are <a class="reference internal" href="#sv-upgrades-state"><span class="std std-ref">preserved</span></a>.</p></li>
<li><p>Once a BFT majority (i.e., &gt;) of SVs have initialized their upgraded nodes, the new version of the synchronizer (with an incremented migration ID and, typically, a new version of the core Canton components) becomes operational automatically. The end of the downtime window is therefore determined by the speed at which a sufficient number of SVs complete the necessary deployment and initialization steps.</p></li>
<li><p>The remaining (Canton and CometBFT) components of the old synchronizer can be retired now. We recommend to only do so after (non-super) validators have had sufficient time to <a class="reference internal" href="../validator_operator/validator_major_upgrades.html#validator-upgrades"><span class="std std-ref">catch up</span></a> to the latest state from before the pause.</p></li>
</ol>
</section>
<section id="technical-details">
<h2>Technical Details<a class="headerlink" href="#technical-details" title="Link to this heading"></a></h2>
<p>The following section assumes that the SV node on the original synchronizer was deployed using the instructions in <a class="reference internal" href="sv_helm.html#sv-helm"><span class="std std-ref">Kubernetes-Based Deployment of a Super Validator node</span></a>.</p>
<section id="state-and-migration-ids">
<span id="sv-upgrades-state"></span><h3>State and Migration IDs<a class="headerlink" href="#state-and-migration-ids" title="Link to this heading"></a></h3>
<p>Synchronizer upgrades with downtime effectively clone the state of the existing synchronizer, with some finer points:</p>
<ul class="simple">
<li><p>All <a class="reference internal" href="sv_operations.html#sv-identities-overview"><span class="std std-ref">identities</span></a> are reused, which includes all party IDs, all participant, sequencer and mediator (node) identities, as well as CometBFT node identities.
This is realized through exporting and importing a <a class="reference internal" href="#sv-upgrades-dumps"><span class="std std-ref">migration dump</span></a>.</p></li>
<li><p>Active ledger state is preserved.
This is also realized through exporting and importing a <a class="reference internal" href="#sv-upgrades-dumps"><span class="std std-ref">migration dump</span></a>.</p></li>
<li><p>Historical app state (such as transaction history) is preserved.
This is realized through persisting and reusing the (PostgreSQL) databases of the SV node apps (<code class="docutils literal notranslate"><span class="pre">sv</span></code>, <code class="docutils literal notranslate"><span class="pre">scan</span></code>, <code class="docutils literal notranslate"><span class="pre">validator</span></code>).</p></li>
<li><p>The CometBFT blockchain is <strong>not</strong> preserved.
The upgraded synchronizer starts with a fresh CometBFT chain.
CometBFT node state from the existing synchronizer is discarded.</p></li>
</ul>
<p>For avoiding conflicts across migrations, we use the concept of a migration ID:</p>
<ul class="simple">
<li><p>The migration ID is 0 during the initial bootstrapping of a network and incremented after each synchronizer upgrade with downtime.</p></li>
<li><p>The SV node apps (<code class="docutils literal notranslate"><span class="pre">sv</span></code>, <code class="docutils literal notranslate"><span class="pre">scan</span></code>, <code class="docutils literal notranslate"><span class="pre">validator</span></code>) are aware of the migration ID and use it for ensuring the consistency of their internal stores and avoiding connections to nodes on the wrong synchronizer.</p></li>
<li><p>The SV node Canton components (participant, sequencer, mediator) are <strong>not</strong> directly aware of the migration ID.
To keep Canton components apart across migrations
(new Canton components are needed to upgrade across non-backwards-compatible changes to the Canton software),
we deploy them with migration ID-specific names and ingress rules (see <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a>).
We furthermore configure Canton components to create and use migration ID-specific (PostgreSQL) database names.
As part of <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>, the SV app will initialize Canton components based on its configured migration ID.</p></li>
<li><p>The SV node CometBFT component is aware of the migration ID - it is used for forming the CometBFT chain ID.</p></li>
</ul>
</section>
<section id="migration-dumps">
<span id="sv-upgrades-dumps"></span><h3>Migration Dumps<a class="headerlink" href="#migration-dumps" title="Link to this heading"></a></h3>
<p>Migration dumps contain identity and transaction data from all of an SVs Canton components
(participant, sequencer, and mediator) connected to the global synchronizer that is being upgraded.
When using the official Helm charts and following the <a class="reference internal" href="sv_helm.html#sv-helm"><span class="std std-ref">Helm-based deployment documentation</span></a>,
the migration dump is automatically created once a scheduled synchronizer upgrade begins and the existing synchronizer has been paused.
As part of the Helm-based deployment of the SV app (<code class="docutils literal notranslate"><span class="pre">splice-sv-node</span></code>),
a persistent Kubernetes volume is attached to the <code class="docutils literal notranslate"><span class="pre">sv-app</span></code> pod and configured as the target storage location for migration dumps.
When redeploying the SV app as part of the migration process (see <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>),
the SV app will automatically consume the migration dump and initialize new components (see <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a>)
based on the contents of this dump.</p>
</section>
<section id="deploying-new-canton-components-and-cometbft-node">
<span id="sv-upgrades-deploying-domain"></span><h3>Deploying new Canton Components and CometBFT Node<a class="headerlink" href="#deploying-new-canton-components-and-cometbft-node" title="Link to this heading"></a></h3>
<p>Repeat the steps described in <a class="reference internal" href="sv_helm.html#helm-sv-install"><span class="std std-ref">Installing the Software</span></a> for installing the participant, sequencer, mediator and CometBFT components,
substituting the migration ID (<code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span></code>) with the target migration ID after the upgrade (typically the existing synchronizers migration ID + 1).</p>
<p>While doing so, please note the following:</p>
<ul class="simple">
<li><p>You dont need to wait for the existing synchronizer to have paused before performing these steps.
Performing them well in advance of the scheduled downtime can reduce the downtime (s.a. <a class="reference internal" href="#sv-upgrades-testing-preparation"><span class="std std-ref">Individual Preparation</span></a>).</p></li>
<li><p>Please make sure to pick the correct (incremented) <code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span></code> when following the steps.</p></li>
<li><p>Please make sure that all new Helm charts you install as part of this step have the expected Helm chart version; during an actual upgrade this version will be different from the one on your existing deployment.</p></li>
<li><p>Please dont uninstall any Helm charts installed as part of the original deployment run (with the smaller migration ID).
We deliberately keep SV participants and core synchronizer components running longer so that validators get a chance to sync up to the latest state from before the pause,
which they need to do for successfully completing their part of the migration.</p></li>
<li><p>Note that repeating the process with the incremented migration ID will result in the deployment of new pods with new Canton components and a new CometBFT node.
Among other things, these deployments differ in k8s-internal host names, which are formed based on the migration ID.</p></li>
<li><p>We recommend disabling CometBFT <a class="reference internal" href="sv_helm.html#helm-cometbft-state-sync"><span class="std std-ref">state sync</span></a> while going through a synchronizer migration, to reduce dependencies on the readiness of other SVs.
To do so, please modify the file <code class="docutils literal notranslate"><span class="pre">splice-node/examples/sv-helm/cometbft-values.yaml</span></code> so that <code class="docutils literal notranslate"><span class="pre">stateSync.enable</span></code> is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Please ensure that your ingress rules are extended accordingly to accommodate the new pods.
Revisit <a class="reference internal" href="sv_helm.html#helm-sv-ingress"><span class="std std-ref">Configuring the Cluster Ingress</span></a> with the updated migration ID in mind.</p></li>
<li><p>Note that the exposed CometBFT port and CometBFT <code class="docutils literal notranslate"><span class="pre">externalAddress</span></code> are changed due to a limitation in CometBFT.
There is no fundamental need to use the port numbers suggested in the runbook, the only requirement is that either the (external) host IP of the CometBFT pod must be different for each migration ID or its (external) port number.</p></li>
</ul>
</section>
<section id="catching-up-before-the-migration">
<span id="sv-upgrades-catching-up"></span><h3>Catching Up Before the Migration<a class="headerlink" href="#catching-up-before-the-migration" title="Link to this heading"></a></h3>
<p>In order for the migration to the new synchronizer to be safe and successful, it is important that the SV node is fully caught up on the existing synchronizer before proceeding to <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>.</p>
<ul class="simple">
<li><p>For making sure that the SV participant has caught up and the <a class="reference internal" href="#sv-upgrades-dumps"><span class="std std-ref">migration dump</span></a> has been created as expected, operators can check the logs of the <code class="docutils literal notranslate"><span class="pre">sv-app</span></code> pod for the message <code class="docutils literal notranslate"><span class="pre">Wrote</span> <span class="pre">domain</span> <span class="pre">migration</span> <span class="pre">dump</span></code>.</p></li>
<li><p>For making sure that alls apps - <code class="docutils literal notranslate"><span class="pre">sv-app</span></code>, <code class="docutils literal notranslate"><span class="pre">scan-app</span></code>, and <code class="docutils literal notranslate"><span class="pre">validator-app</span></code> - have caught up, operators can check the logs of the respective pods for <code class="docutils literal notranslate"><span class="pre">Ingested</span> <span class="pre">transaction</span></code> messages.
If the latest such message for a given app is 10 or more minutes old, that app has very likely (with a large safety margin) caught up to the state on the participant, and hence to the state of the existing (paused) synchronizer.</p></li>
</ul>
</section>
<section id="updating-apps">
<span id="sv-upgrades-deploying-apps"></span><h3>Updating Apps<a class="headerlink" href="#updating-apps" title="Link to this heading"></a></h3>
<p>Repeat the steps described in <a class="reference internal" href="sv_helm.html#helm-sv-install"><span class="std std-ref">Installing the Software</span></a> for installing the <code class="docutils literal notranslate"><span class="pre">sv</span></code>, <code class="docutils literal notranslate"><span class="pre">scan</span></code> and <code class="docutils literal notranslate"><span class="pre">validator</span></code> components,
substituting the migration ID (<code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span></code>) with the target migration ID after the upgrade (typically the existing synchronizers migration ID + 1).</p>
<p>While doing so, please note the following:</p>
<ul class="simple">
<li><p>Please make sure to pick the correct (incremented) <code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span></code> when following the steps.</p></li>
<li><p>Please modify the file <code class="docutils literal notranslate"><span class="pre">splice-node/examples/sv-helm/sv-values.yaml</span></code> so that <code class="docutils literal notranslate"><span class="pre">migration.migrating</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.
This will ensure that the SV app will consume the migration dump and initialize new components based on the contents of this dump.
Also set <code class="docutils literal notranslate"><span class="pre">migration.legacyId</span></code> to the value of migration ID before incremented. (<code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span></code> - 1).</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">upgrade</span></code> in place of <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">install</span></code> for the <code class="docutils literal notranslate"><span class="pre">sv</span></code>, <code class="docutils literal notranslate"><span class="pre">scan</span></code> and <code class="docutils literal notranslate"><span class="pre">validator</span></code> charts
and do not uninstall any Helm charts installed as part of the original deployment run (with the smaller migration ID).</p></li>
<li><p>Please make sure that all Helm chart deployments you upgrade as part of this step are upgraded to the expected Helm chart version; during an actual upgrade this version will be different from the one on your existing deployment.</p></li>
<li><p>No ingress rules need to be updated as part of this step.
Once the redeployment is complete the existing ingress rules will apply to the updated pods.</p></li>
</ul>
</section>
<section id="recovering-from-a-failed-upgrade">
<h3>Recovering from a failed upgrade<a class="headerlink" href="#recovering-from-a-failed-upgrade" title="Link to this heading"></a></h3>
<p>In the event of a failed upgrade, Each SV must submit a topology transaction to resume the old synchronizer. This can be triggered using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;https://sv.sv.YOUR_HOSTNAME/api/sv/v0/admin/domain/unpause&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;authorization: Bearer &lt;token&gt;&quot;</span>
</pre></div>
</div>
<p>where <cite>&lt;token&gt;</cite> is an OAuth2 Bearer Token obtained from your OAuth provider. For context, see the Authentication section <a class="reference internal" href="../app_dev/overview/splice_app_apis.html#app-auth"><span class="std std-ref">here</span></a>.</p>
<p>The command will complete successfully once a sufficient number of SVs have executed it. The old synchronizer will then be un-paused.</p>
</section>
</section>
<section id="organizational-details">
<span id="sv-upgrades-organization"></span><h2>Organizational Details<a class="headerlink" href="#organizational-details" title="Link to this heading"></a></h2>
<section id="coordination-calls">
<span id="sv-upgrades-coordination"></span><h3>Coordination calls<a class="headerlink" href="#coordination-calls" title="Link to this heading"></a></h3>
<p>For keeping upgrade downtimes short and assisting with the quick resolution of individual issues, we propose to perform upgrades and <a class="reference internal" href="#sv-upgrades-testing"><span class="std std-ref">upgrade tests</span></a> in a synchronized manner, with coordination over a group call (Zoom meeting). All SV operators will hereby be invited to join a call that starts shortly before the beginning of the downtime window (step 4 above) and ends once the upgrade and synchronizer migration has concluded (step 10 above). Our aim is that the core of the upgrade procedure (steps 4-10) can in principle be completed within one hour, realizing that the first coordinated tests will likely take longer.</p>
<p>Each SV must be represented in these calls by at least one person that is capable of performing the steps described in <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a> and <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>.
The operators representing an SV must be:</p>
<ul class="simple">
<li><p>Familiar with the technical details around the SVs deployment.</p></li>
<li><p>Capable (in terms of both skills and permissions) to interact with the SVs node deployment via Helm and (for debugging with support from the CN team) Kubernetes (kubectl) commands.</p></li>
<li><p>For being able to amend potential errors during <a class="reference internal" href="#sv-upgrades-testing-preparation"><span class="std std-ref">preparation</span></a>: Capable (in terms of both skills and permissions) to register new ingress rules for internal synchronizer components (sequencer, mediator and CometBFT) and SV participants. Resulting addresses will only be relevant to technical personnel and will follow a schema such as <code class="docutils literal notranslate"><span class="pre">component-migrationId.hostname</span></code>. Note that for fully supporting the migration flow for CometBFT nodes, it will also be necessary to allow communication over additional ports.</p></li>
</ul>
</section>
</section>
<section id="testing">
<span id="sv-upgrades-testing"></span><h2>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h2>
<p>The success of synchronizer upgrades and the duration of downtime both depend on the effectiveness of all SVs in performing the necessary upgrading steps. We therefore recommend that the DSO performs <a class="reference internal" href="#sv-upgrades-testing-coordinated"><span class="std std-ref">coordinated tests</span></a>
before attempting an upgrade on MainNet.
Mirroring the recommended process for an actual upgrade,
we also recommend that SVs perform <a class="reference internal" href="#sv-upgrades-testing-preparation"><span class="std std-ref">preparation</span></a> steps in advance of every coordinated test.</p>
<section id="individual-preparation">
<span id="sv-upgrades-testing-preparation"></span><h3>Individual Preparation<a class="headerlink" href="#individual-preparation" title="Link to this heading"></a></h3>
<p>The following steps can be performed before the downtime window has started
and even before a synchronizer upgrade has been formally scheduled:</p>
<ol class="arabic simple">
<li><p>Ensure that the <a class="reference internal" href="sv_backup.html#sv-backups"><span class="std std-ref">backup and restore</span></a> process for the SV works as expected.</p></li>
<li><p>Deploy a new version of the CometBFT component as per <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a>
(<code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span> <span class="pre">+=</span> <span class="pre">1</span></code> compared to the currently active synchronizer),
including setting up the ingress for this component.
Ensure that the pod reports as healthy.
For checking that the ingress rules are set up correctly, ensure that TCP connections to the new CometBFT port are possible,
for example by using the <code class="docutils literal notranslate"><span class="pre">nc</span></code> command: <code class="docutils literal notranslate"><span class="pre">nc</span> <span class="pre">-vz</span> <span class="pre">&lt;cometbft</span> <span class="pre">host&gt;</span> <span class="pre">&lt;cometbft</span> <span class="pre">port&gt;</span></code>.</p></li>
<li><p>Deploy new versions of the Canton components (participant, sequencer, mediator) as per <a class="reference internal" href="#sv-upgrades-deploying-domain"><span class="std std-ref">Deploying new Canton Components and CometBFT Node</span></a>
(<code class="docutils literal notranslate"><span class="pre">MIGRATION_ID</span> <span class="pre">+=</span> <span class="pre">1</span></code> compared to the currently active synchronizer),
including setting up the ingress for the new sequencer.
Note that these components are only initialized by the SV app once the synchronizer migration has started.
Ensure that all pods report as healthy.
Note that when using <code class="docutils literal notranslate"><span class="pre">grpcurl</span></code> to check that the ingress rule for the new sequencer is set up correctly
(as described in <a class="reference internal" href="sv_helm.html#helm-sv-ingress"><span class="std std-ref">Configuring the Cluster Ingress</span></a>), you will get a <code class="docutils literal notranslate"><span class="pre">rpc</span> <span class="pre">error:</span> <span class="pre">code</span> <span class="pre">=</span> <span class="pre">Unavailable</span></code> error as the sequencer is not yet initialized
(and its public gRPC endpoint is therefore not yet available).
If the rpc error details include a <code class="docutils literal notranslate"><span class="pre">delayed</span> <span class="pre">connect</span> <span class="pre">error:</span> <span class="pre">111</span></code> message,
this is an indicator that the ingress rule is set up correctly.</p></li>
</ol>
<p>We recommend that all SVs perform these steps before a <a class="reference internal" href="#sv-upgrades-testing-coordinated"><span class="std std-ref">coordinated test</span></a> starts and signal their readiness once they have done so.</p>
</section>
<section id="coordinated-tests">
<span id="sv-upgrades-testing-coordinated"></span><h3>Coordinated Tests<a class="headerlink" href="#coordinated-tests" title="Link to this heading"></a></h3>
<p>Coordinated tests mirror the steps that will later be used for upgrading MainNet (see <a class="reference internal" href="#sv-upgrades-overview"><span class="std std-ref">above</span></a>).
Specifically, coordinated tests involve:</p>
<ul class="simple">
<li><p>Scheduling a <a class="reference internal" href="#sv-upgrades-coordination"><span class="std std-ref">group call</span></a> covering the planned synchronizer downtime.</p></li>
<li><p>Pausing the global synchronizer via a governance vote.</p></li>
<li><p>Each SV making sure that all of its nodes components have caught up to the final state of the existing synchronizer - see <a class="reference internal" href="#sv-upgrades-catching-up"><span class="std std-ref">Catching Up Before the Migration</span></a>.</p></li>
<li><p>Creating full backups of SV nodes after they have fully caught up and the synchronizer has been paused.</p></li>
<li><p>Performing all remaining deployment steps necessary for a successful migration to the new synchronizer.
If <a class="reference internal" href="#sv-upgrades-testing-preparation"><span class="std std-ref">Individual Preparation</span></a> was followed, this involves only the steps outlined in <a class="reference internal" href="#sv-upgrades-deploying-apps"><span class="std std-ref">Updating Apps</span></a>.
It is fully supported that SVs perform these deployment steps concurrently after the synchronizer has been paused.</p></li>
<li><p>Each SV verifying that its local state is consistent with the state of the global synchronizer before the pause.
For example, verifying that their own coin balance is as expected.</p></li>
<li><p>Once all SVs (or a governance threshold of SVs) have completed the migration:
Collectively verifying that the new synchronizer is healthy and operational.
Synchronizer health can be inferred from monitoring signals such as timely <code class="docutils literal notranslate"><span class="pre">SV</span> <span class="pre">Status</span> <span class="pre">Reports</span></code> from all SVs.</p></li>
<li><p>Agreeing on a timeline for decommissioning the Canton and CometBFT nodes connected to the original (pre-migration) synchronizer.</p></li>
<li><p>Before we decommission the Canton and CometBFT nodes connected to the original (pre-migration) synchronizer, we should remove <code class="docutils literal notranslate"><span class="pre">migration.legacyId</span></code> we have set previously in the file <code class="docutils literal notranslate"><span class="pre">splice-node/examples/sv-helm/sv-values.yaml</span></code>.</p></li>
</ul>
<p>We recommend to perform at least one coordinated test on TestNet, with the exact same configuration and versions that will be used for the upgrade on MainNet,
before scheduling a MainNet upgrade with downtime.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sv_upgrades.html" class="btn btn-neutral float-left" title="Upgrades" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sv_backup.html" class="btn btn-neutral float-right" title="Backups" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright  2025, Digital Asset.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>